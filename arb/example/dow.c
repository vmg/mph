/*
 * d=2
 * n=29
 * m=28
 * c=1.03
 * maxlen=1
 * minklen=3
 * maxklen=9
 * minchar=70
 * maxchar=121
 * loop=0
 * numiter=20749
 * seed=
 */

static int g[] = {
	0, 3, 6, 12, 13, -3, 3, 19, 20, -5,
	-14, -13, -7, -6, -15, 17, 12, 18, 4, 7,
	-14, 11, -11, 17, 4, 12, -13, -5, 2, 
};

static int T0[] = {
	28, 8, 6, 19, 5, 14, 4, 10, 19, 14,
	24, 28, 16, 27, 18, 22, 26, 2, 28, 10,
	4, 10, 12, 6, 14, 17, 15, 27, 6, 16,
	25, 26, 16, 23, 8, 21, 9, 13, 3, 20,
	19, 19, 12, 6, 17, 1, 20, 14, 24, 19,
	25, 20, 
};

static int T1[] = {
	26, 21, 16, 24, 22, 17, 14, 18, 11, 6,
	2, 6, 24, 23, 4, 7, 1, 25, 9, 11,
	16, 18, 18, 1, 22, 10, 17, 7, 17, 27,
	19, 14, 19, 27, 1, 12, 8, 15, 23, 19,
	21, 17, 18, 9, 11, 14, 8, 12, 10, 17,
	24, 27, 
};

#define uchar unsigned char

int
hash(const uchar *key)
{
	unsigned f0, f1;
	const uchar *kp = key;

	for (f0=f1=0; *kp; ++kp) {
		if (*kp < 70 || *kp > 121)
			return -1;
		if (kp-key > 8)
			return -1;
		f0 += T0[-70 + *kp];
		f1 += T1[-70 + *kp];
	}

	if (kp-key < 3)
		return -1;

	f0 %= 29;
	f1 %= 29;

	return g[f0] + g[f1];
}
